<div id="post-form-container">

    <h1>Submit a Request</h1>
    <p id="address-preview"></p>
    <small>Click or tap the map to select a location. Tap in the search box to search for a location</small>
    <input id="pac-input" class="controls" type="text" placeholder="Search Box">
    <div id="map-canvas"></div>

    <% if logged_in? && !current_user.nil?%>
        <%= simple_form_for @post, html: {class:'form-horizontal', multipart: true} do |f| %>

            <%= f.input :poster_id, :as => :hidden, :input_html => {:value => current_user.id} %>

            <%= render 'partials/form_errors', record: @post %>

            <%= f.input :street_1, :as => :hidden, input_html: {class: "form-control", id: "street-1"} %>
        
            <%= f.input :street_2, :as => :hidden, input_html: {class: "form-control", id: "street-2"} %>
            <div>
                <%= f.input :city, :as => :hidden, input_html: {class: "form-control", id: "city" }, wrapper_html: { class: "inline"} %>

                <%= f.input :state, :as => :hidden, input_html: {class: "form-control", id: "state" }, wrapper_html: { class: "inline"} %>

                <%= f.input :zip, :as => :hidden, input_html: {class: "form-control", id: "zip"}, wrapper_html: { class: "inline"} %>
            </div>

             <% unless @all_needs.empty? %>
                <div id="needs-list">
                    <%= render :partial => "form_template" %>
                </div>
             <% end %>

             
             <% unless @alliances.empty? %>
                 <div id="sharings-list">
                    <div class = "title">* Sharing Option:<small> This post will be shared among the checked alliances</small></div>
                    <div class = "needblock">
                        <div class = "need-category">
                            <%= collection_check_boxes :alliances, :ids, @alliances, :id, :name do |al| %>
                                <div>
                                    <%= al.label %>
                                    <%= al.check_box(checked: "") %>
                                </div>
                                <small>
                                    <div class = "dlink"><%= "Click to see members: "%></div>
                                    <div class = "details"><%= al.object.all_org_names%></div>
                                </small>
                            <% end %>
                            <div class = "small">If no alliances are checked, then the post is private to your organizaiton</div>
                        </div>
                    </div>
                </div>
             <%end%>


            <%= f.input :number_people, label: "Number of People", input_html: {class:"form-control" }, :required => true %>

            <%= f.fields_for :comments do |c| %>
                 <%= c.input :content,:as => :text,  :label => "Comment",input_html: {class: "form-control", id: "comment"} %>
                 <%= c.input :user_id, :as => :hidden, :input_html => {:value => current_user.id} %>
            <%end%>

            <div id="submit" class="button-wrapper">
                <input type="submit" class="button" value="Submit Request" />
            </div>
        <% end %>

    <% else %>
        <p>Please <%= link_to "login", login_path %> to create a new request!</p>
    <% end %>
</div>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCs_9i8wDJ_RJrk7ZiG2zi6oNh8X-1akSU&libraries=places&callback=initPostFormMap" async defer></script>